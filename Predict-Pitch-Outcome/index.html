<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pitch Outcome Prediction</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      background-color: #f9f9f9;
      margin: 0;
      color: #333;
      padding: 0;
    }
    header {
      background-color: #2c3e50;
      color: white;
      padding: 40px 20px;
      text-align: center;
    }
    header h1 {
      margin: 0 0 10px;
      font-size: 2.5em;
    }
    header p {
      font-size: 1.2em;
      max-width: 800px;
      margin: 0 auto;
    }
    .container {
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px;
    }
    h2 {
      color: #2c3e50;
      border-bottom: 2px solid #ddd;
      padding-bottom: 5px;
    }
    ul {
      margin-left: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #34495e;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #f0f0f0;
    }
    .highlight {
      background-color: #d1f5d3;
      font-weight: bold;
    }
    footer {
      text-align: center;
      padding: 30px;
      background-color: #ecf0f1;
      color: #666;
      margin-top: 60px;
    }
    .cta a {
      display: inline-block;
      margin: 10px;
      padding: 10px 20px;
      background-color: #2c3e50;
      color: white;
      text-decoration: none;
      border-radius: 6px;
    }
    .cta a:hover {
      background-color: #1a252f;
    }
  </style>
</head>
<body>

<header>
  <h1>MLB Pitch Outcome Prediction</h1>
  <p>Two-tier machine learning system to classify every MLB pitch into meaningful outcomes using real Statcast data (2021–2024).</p>
</header>

<div class="container">

  <h2>Introduction and Motivation</h2>
  <p>
    This work is a core part of baseball analytics: accurately predicting the outcome of a pitch using available data. It's designed to serve both predictive and strategic functions, suitable for scouting or game-calling analysis.
  </p>

  <h2>Data Collection and Modeling System</h2>
  <ul>
    <li><strong>Data Source:</strong> Statcast data via <code>pybaseball</code> API for 2021–2024 regular seasons</li>
    <li><strong>Two-Tier Classifier:</strong>
      <ul>
        <li><strong>Tier 1:</strong> Classifies pitch into Ball, Strike, or Ball In Play</li>
        <li><strong>Tier 2:</strong> For a Ball In Play only — classifies further into Single, Double, Triple, HR, or Out</li>
      </ul>
    </li>
    <li><strong>Most Optimal Models:</strong> Gradient boosting models: XGBoost, LightGBM, CatBoost</li>
    <li><strong>Evaluation:</strong> Weighted F1 Score and Accuracy</li>
  </ul>

  <h2>Feature Engineering</h2>
  <p>Features were designed to reflect both context and pitch physics:</p>
  <ul>
    <li><strong>Game Context:</strong> inning, outs, runners on base, score differential</li>
    <li><strong>Pitch Features:</strong> speed, spin rate, axis, location, movement</li>
    <li><strong>Sequence Dynamics:</strong> pitch number in at-bat, ball-strike count</li>
    <li><strong>Advanced:</strong> release extension, effective speed, launch angle/speed (Tier 2)</li>
  </ul>

  <h2>Model Architecture</h2>
  <p>
    The system uses a two-tiered prediction pipeline. Tier 1 determines the broad outcome, and Tier 2 determines the details of a ball in play.
  </p>

  <pre style="background:#eee;padding:10px;border-radius:4px;">
              ┌──────────────┐
              │ Input Pitch  │
              └──────┬───────┘
                     │
              ┌──────▼──────┐
              │  Tier 1 ML  │
              └──────┬──────┘
         Ball/Strike │ Ball In Play
                     ▼
               ┌─────┴─────┐
               │ Tier 2 ML │
               └───────────┘
        (Single / Double / HR / Out / etc.)
  </pre>

  <h2>Performance Summary</h2>
  <p>Evaluation was done across all 9 combinations of Tier1 × Tier2 models.</p>

  <table>
    <thead>
      <tr>
        <th>Tier 1</th><th>Tier 2</th><th>Tier 1 Accuracy</th><th>Tier 1 F1</th><th>Tier 2 Accuracy</th><th>Tier 2 F1</th>
      </tr>
    </thead>
    <tbody>
      <tr class="highlight"><td>xgboost</td><td>xgboost</td><td>0.724</td><td>0.715</td><td>0.766</td><td>0.744</td></tr>
      <tr><td>xgboost</td><td>catboost</td><td>0.724</td><td>0.715</td><td>0.610</td><td>0.652</td></tr>
      <tr><td>xgboost</td><td>lightgbm</td><td>0.724</td><td>0.715</td><td>0.629</td><td>0.667</td></tr>
      <tr class="highlight"><td>lightgbm</td><td>xgboost</td><td>0.715</td><td>0.713</td><td>0.766</td><td>0.744</td></tr>
      <tr><td>lightgbm</td><td>catboost</td><td>0.715</td><td>0.713</td><td>0.610</td><td>0.652</td></tr>
      <tr><td>lightgbm</td><td>lightgbm</td><td>0.715</td><td>0.713</td><td>0.629</td><td>0.667</td></tr>
      <tr><td>catboost</td><td>xgboost</td><td>0.706</td><td>0.703</td><td>0.766</td><td>0.744</td></tr>
      <tr><td>catboost</td><td>catboost</td><td>0.706</td><td>0.703</td><td>0.610</td><td>0.652</td></tr>
      <tr><td>catboost</td><td>lightgbm</td><td>0.706</td><td>0.703</td><td>0.629</td><td>0.667</td></tr>
    </tbody>
  </table>

  <h2>Key Insights</h2>
  <ul>
    <li><strong>XGBoost consistently performs best</strong> across both tiers — strong generalization and calibration</li>
    <li><strong>Tier 2 accuracy of 76.6%</strong> for batted ball outcomes is competitive with proprietary models</li>
    <li><strong>Model generalizes across seasons</strong></li>
  </ul>

  <h2>Conclusion</h2>
  <p>
    This project simulates real-world decision systems in professional baseball. With consistent high-tier performance, it demonstrates the feasibility of predictive pitch modeling at scale, even with just Statcast data.
  </p>

  <h2>Code</h2>
  <p>
    All code, data processing functions, and model training pipelines are available here:
    <a href="https://github.com/schilamkur/Pitch-Outcome-Prediction.git" target="_blank">GitHub Repository</a>.
    </p>
</div>

<footer>
    &copy; 2025 Siddharth Chilamkur &mdash; All rights reserved.
</footer>

</body>
</html>
